#!/bin/bash
#SBATCH --job-name=aorl
#SBATCH --open-mode=append
#SBATCH -o /global/scratch/users/jenniferzhao/logs/%A_%a.out
#SBATCH -e /global/scratch/users/jenniferzhao/logs/%A_%a.err
#SBATCH --time=36:00:00
#SBATCH --mem=64G
#SBATCH --cpus-per-task=4
#SBATCH --gres=gpu:A5000:1
#SBATCH --account=co_rail
#SBATCH --partition=savio4_gpu
#SBATCH --qos=rail_gpu4_high
#SBATCH --requeue
#SBATCH --array=1-12%16

TASK_ID=$((SLURM_ARRAY_TASK_ID-1))
PARALLEL_N=2
JOB_N=24

COM_ID_S=$((TASK_ID * PARALLEL_N + 1))
source ~/.bashrc
micromamba activate aorl
export PYTHONPATH="../:${PYTHONPATH}"

declare -a commands=(
 [1]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1456162036334.s_27680590_6.20250829_185905_857.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc batch'
 [2]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1456162036334.s_27680590_6.20250829_185905_857.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc sample'
 [3]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1453467320942.s_27680626_4.20250829_185906_336.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc batch'
 [4]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1453467320942.s_27680626_4.20250829_185906_336.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc sample'
 [5]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1448342040171.s_27680619_3.20250829_185930_100.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc batch'
 [6]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1448342040171.s_27680619_3.20250829_185930_100.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc sample'
 [7]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1438812371566.s_27680617_1.20250829_190015_646.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc batch'
 [8]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1438812371566.s_27680617_1.20250829_190015_646.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc sample'
 [9]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1436627854958.s_27680618_2.20250829_185820_547.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc batch'
 [10]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1436627854958.s_27680618_2.20250829_185820_547.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc sample'
 [11]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1426623563374.s_27680619_3.20250829_185930_100.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc batch'
 [12]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1426623563374.s_27680619_3.20250829_185930_100.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc sample'
 [13]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1414600722027.s_27680590_6.20250829_185845_686.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc batch'
 [14]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1414600722027.s_27680590_6.20250829_185845_686.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc sample'
 [15]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1414321273454.s_27680627_5.20250829_185845_775.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc batch'
 [16]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1414321273454.s_27680627_5.20250829_185845_775.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc sample'
 [17]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1452282852974.s_27680618_2.20250829_185841_310.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc batch'
 [18]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1452282852974.s_27680618_2.20250829_185841_310.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc sample'
 [19]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1448103063147.s_27680617_1.20250829_190015_646.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc batch'
 [20]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1448103063147.s_27680617_1.20250829_190015_646.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc sample'
 [21]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1441449117294.s_27680626_4.20250829_185845_562.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc batch'
 [22]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1441449117294.s_27680626_4.20250829_185845_562.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc sample'
 [23]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1433843123822.s_27680627_5.20250829_185906_465.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc batch'
 [24]='python3 train_value.py --run_group train_value2_3 --env_name humanoidmaze-medium-navigate-oraclerep-v0 --agent ../agents/gcfql.py --dataset_dir ../../scratch/data/humanoidmaze-medium-navigate-v0 --offline_steps 2000000 --save_interval 200000 --save_dir ../../scratch/gcfql/ --agent.alpha 300 --agent.actor_type best-of-n --agent.train_goal_proposer=True --agent.actor_hidden_dims 512,512,512,512 --agent.value_hidden_dims 512,512,512,512 --agent.batch_size 256 --agent.num_actions 8 --agent.num_qs 2 --json_path ../jsons/data.json --agent.awr_invtemp 1.0 --agent.discount 0.995 --restore_path ../../scratch/gcfql/horizon-reduction/gcfql_maze_oracle4_8/sd000_1433843123822.s_27680627_5.20250829_185906_465.gcfql_maze_oracle4_8 --restore_epoch 2000000 --q_pred_calc sample'
)

cd /home/jennifer/aorl/horizon_reduction

parallel --delay 20 --linebuffer -j 2 {1} ::: "${commands[@]:$COM_ID_S:$PARALLEL_N}"
